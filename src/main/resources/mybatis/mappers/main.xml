<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="main">
	<select id="menuList" resultType="com.project_1.vo.BoardVo">
		<![CDATA[
			select 
			    *
			from 
			    board_name
		]]>
	</select>
	
	<select id="communityBoardList" resultType="int">
		<![CDATA[
			SELECT
			    boardNo
			FROM
			    board_name
			where
			    boardType=1
		]]>
	</select>
	
	<select id="communityContentList" parameterType="int" resultType="com.project_1.vo.ContentVo">
		<![CDATA[
			SELECT
			    *
			FROM
			    (SELECT
			        contentNo,
			        boardNo,
			        boardTitle
			    FROM
			        board_content
			    where
			        boardNo = #{boardNo}
			    order by boardtime desc)bc
			where
			    rownum < 3
		]]>
	</select>
	
	<select id="countContent" parameterType="int" resultType="int">
		<![CDATA[
			SELECT
			    count(contentNo)
			FROM
			    board_content
			where
			    boardNo = #{boardNo}
		]]>
	</select>
	
	<select id="contentList" parameterType="map" resultType="com.project_1.vo.ContentVo">
		<![CDATA[
			SELECT
			    *
			FROM
			    (SELECT
			        rownum rw,
			        contentNo,
			        boardTitle,
			        boardTime
			    FROM
			        (SELECT
			            contentNo,
			            boardtitle,
			            TO_CHAR(boardTime,'YYYY-MM-DD') boardTime
			        FROM
			            board_content
			        where
			            boardNo = #{boardNo}
			        order by contentno desc))
			where
			    rw >= #{startPage}
			and
			    rw <= #{endPage}
		]]>
	</select>
	
	<select id="content" parameterType="int" resultType="com.project_1.vo.ContentVo">
		<![CDATA[
			SELECT
			    bc.boardcontent,
			    TO_CHAR(bc.boardTime,'YYYY-MM-DD') boardTime,
			    bc.boardtitle,
			    bi.imgname
			FROM
			    board_content bc,
			    board_img bi
			where
			    bc.contentno = bi.contentno(+)
			and
			    bc.contentno = #{contentNo}
		]]>
	</select>
	
	<insert id="writecontent" parameterType="com.project_1.vo.ContentVo">
		<selectKey keyProperty="contentNo" resultType="int" order="BEFORE">
			select SQ_BOARD_CONTENT.nextval from dual
		</selectKey>
		<![CDATA[
			insert into board_content
			values(#{contentNo}, #{boardNo},#{boardContent}, sysdate, #{boardTitle})
		]]>
	</insert>
	
	<insert id="insertImg" parameterType="map">
		<![CDATA[
			insert into board_img
			values(#{contentNo}, #{imgName}, 0)
		]]>
	</insert>
	
	<delete id="delete" parameterType="map">
		<![CDATA[
			delete from board_content
			where contentNo = ${contentNo}
		]]>
	</delete>
	
	<select id="login" parameterType="com.project_1.vo.UserVo" resultType="int">
		<![CDATA[
			SELECT
			    count(*)
			FROM
			    manager
			where
			    managerID = #{managerID}
			and
			    managerPW = #{managerPW}
		]]>
	</select>
	
</mapper>